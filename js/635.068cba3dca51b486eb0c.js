"use strict";(self.webpackChunktoxin=self.webpackChunktoxin||[]).push([[635],{888:(t,e,s)=>{s.d(e,{Z:()=>l});var a=s(755),n=s.n(a),i=s(938),o=s(651),r=s(96);class l extends o.Z{constructor(t){super(t),this.maxLen=Number(t.attr(r.kG)),this.hasControls=void 0!==t.has(r.Lk),this.$text=n()(r.qW,this.$component)}init(){super.init(),this.rows=this.getRows(),this.hasControls&&(this.$clear=this.$component.find(r.oi),this.$accept=this.$component.find(r.xJ)),this.update()}attachEventHandlers(){super.attachEventHandlers(),this.hasControls&&(this.$clear.on("click",(()=>this.handleClearButtonClick())),this.$accept.on("click",(t=>this.handleAcceptButtonClick(t)))),this.rows.forEach((t=>{t.$minus.on("click",(()=>this.handleMinusClick(t.$minus,t.$counter))),t.$plus.on("click",(()=>this.handlePlusClick(t.$minus,t.$counter)))}))}handleClearButtonClick(){this.rows.forEach((t=>{t.$minus.removeClass(r.wz),t.$counter.html(0)})),this.updateText(),this.updateClearButtonVisability()}handleAcceptButtonClick(){this.$component.removeClass(r.M2)}handleMinusClick(t,e){const s=Number(e.html());0!==s&&(1===s&&t.removeClass(r.wz),e.html(s-1),this.update())}handlePlusClick(t,e){const s=Number(e.html());0===s&&t.addClass(r.wz),e.html(s+1),this.update()}setText(t){let e=t.substring(0,this.maxLen);t.length>=this.maxLen&&(e+="..."),this.$text.val(e)}getRows(){return Array.from(n()(r.jk,this.$component)).map((t=>{const e=n()(t),s={$minus:n()(t).find(r.fP),$counter:n()(t).find(r.sH),$plus:n()(t).find(r.S8),countables:null};return void 0!==e.attr(r.gT)&&(s.countables=JSON.parse(n()(t).attr(r.gT))),s}))}areAllCountersZero(){return this.rows.every((t=>0===Number(t.$counter.html())))}update(){this.updateText(),this.updateValue(),this.updateClearButtonVisability(),this.triggerValueChanged()}updateText(){this.areAllCountersZero()?this.setText(""):this.setText(this.calcDropdownText())}updateValue(){this.$component.attr(r.o9,this.calcDropdownValue())}updateClearButtonVisability(){this.areAllCountersZero()?this.$clear.hide():this.$clear.show()}calcDropdownValue(){return this.rows.map((t=>Number(t.$counter.html())))}calcDropdownText(){return this.rows.map((t=>{const e=Number(t.$counter.html());return 0===e?"":`${e} ${(0,i.nK)(e,t.countables)}`})).filter((t=>""!==t)).join(", ")}render(){this.init(),this.attachEventHandlers()}}},822:(t,e,s)=>{s.d(e,{Z:()=>l});var a=s(755),n=s.n(a),i=s(563),o=s(651),r=s(96);class l extends o.Z{constructor(t){super(t),this.texts=n()(r.qW,this.$component),this.isSplit=void 0!==this.$component.attr(r.xD),this.isRange=void 0!==this.$component.attr(r.P4),this.datepicker=this.createCalendar({range:this.isRange});const e=JSON.parse(this.$component.attr(r.hd));this.datepicker.selectDate(e)}handleAcceptButtonClick(){this.$component.removeClass(r.M2)}createCalendar(t={}){const e={...t,$component:this.$component,$content:this.$content,texts:this.texts,isDatepicker:this.isDatepicker,isSplit:this.isSplit,triggerValueChanged:()=>this.triggerValueChanged(),onAcceptButtonClick:()=>this.handleAcceptButtonClick(),altField:this.texts[0],DATE_FROM:r.q8,DATE_TO:r.LX};return new i.Z(e)}}},651:(t,e,s)=>{s.d(e,{Z:()=>o});var a=s(755),n=s.n(a),i=s(96);class o{constructor(t){this.$component=t,this.valueChanged=t.attr(i.KI),this.$dropdowns=n()(i.LI,t),this.$content=n()(i.kL,t)}init(){this.$component.hasClass(i.yH)||this.$content.css("z-index",Number(this.$content.css("z-index"))+1)}attachEventHandlers(){n()(document).on("click",(t=>this.handleOutOfComponentClick(t))),this.$dropdowns.on("click",(t=>this.handleDropdownsClick(t)))}handleOutOfComponentClick({target:t}){0===this.$component.has(t).length&&this.$component.removeClass(i.M2)}handleDropdownsClick({target:t}){0!==n()(t).closest(i.tQ).length&&this.$component.toggleClass(i.M2)}triggerValueChanged(){this.valueChanged&&n()(document).trigger(this.valueChanged)}render(){this.init(),this.attachEventHandlers()}}},575:(t,e,s)=>{s.d(e,{Z:()=>o});var a=s(938),n=s(888),i=s(96);class o extends n.Z{constructor(t){super(t),this.countables=JSON.parse(this.$component.attr(i.Je))}sumAllCounters(){return this.rows.filter((t=>null===t.countables)).reduce(((t,e)=>t+Number(e.$counter.html())),0)}calcDropdownText(){const t=this.sumAllCounters();return[t?`${t} ${(0,a.nK)(t,this.countables)}`:"",...this.rows.filter((t=>null!==t.countables)).map((t=>{const e=Number(t.$counter.html());return 0===e?"":`${e} ${(0,a.nK)(e,t.countables)}`}))].filter((t=>""!==t)).join(", ")}}},96:(t,e,s)=>{s.d(e,{qt:()=>a,LI:()=>n,kL:()=>i,qW:()=>o,oi:()=>r,xJ:()=>l,tQ:()=>c,jk:()=>h,fP:()=>d,sH:()=>u,S8:()=>p,M2:()=>m,yH:()=>$,wz:()=>C,KI:()=>g,o9:()=>k,kG:()=>w,Lk:()=>x,gT:()=>v,Je:()=>_,xD:()=>b,P4:()=>f,hd:()=>T,q8:()=>y,LX:()=>D});const a=".js-dropdown",n=".js-dropdown__dropdowns",i=".js-dropdown__content",o=".js-dropdown__text",r=".js-dropdown__clear-button",l=".js-dropdown__accept-button",c=".js-dropdown__input-box",h=".js-dropdown__row",d=".js-dropdown__button-minus",u=".js-dropdown__counter",p=".js-dropdown__button-plus",m="dropdown_open",$="dropdown_expanded",C="dropdown__button-minus_active",g="data-value-changed",k="data-value",w="data-max-len",x="data-has-controls",v="data-row-countables",_="data-countables",b="data-is-split",f="data-is-range",T="data-selected",y="data-date-from",D="data-date-to"},177:(t,e,s)=>{var a=s(755),n=s.n(a),i=s(651),o=s(822),r=s(888),l=s(575),c=s(96);n()((()=>{n()(c.qt).each(((t,e)=>{const s=n()(e);(function(t,e){switch(t){case"datepicker":return new o.Z(e);case"counter":return new r.Z(e);case"summator":return new l.Z(e);default:return new i.Z(e)}})(s.attr("data-type"),s).render()}))}))},963:(t,e,s)=>{var a=s(755),n=s.n(a),i=(s(177),s(938)),o=s(96);const r=`.js-reservation__datepicker > ${o.qt}`,l=`.js-reservation__guests-dropdown > ${o.qt}`;class c{constructor(t){this.$component=t,this.price=Number(t.attr("data-price")),this.discount=Number(t.attr("data-discount")),this.postfix=t.attr("data-postfix"),this.datepickerValueChanged=t.attr("data-datepicker-value-changed"),this.guestsValueChanged=t.attr("data-guests-value-changed"),this.additionals=JSON.parse(t.attr("data-additionals")),this.$datepicker=n()(n()(r,t)[0]),this.$guests=n()(n()(l,t)[0]),this.$rent=n()(".js-reservation__rent",t),this.$rentTotal=n()(".js-reservation__rent-total",t),this.$additionalTotal=n()(".js-reservation__additional-total",t),this.$totalCost=n()(".js-reservation__total-cost",t)}init(){this.update()}attachEventHandlers(){n()(document).on(this.datepickerValueChanged,(()=>this.handleDatepickerValueChanged())),n()(document).on(this.guestsValueChanged,(()=>this.handleGuestsValueChanged()))}handleDatepickerValueChanged(){this.update()}handleGuestsValueChanged(){this.update()}update(){this.updateRent(),this.updateAdditional(),this.updateTotalCost()}updateRent(){const t=(0,i.R3)(this.price,this.postfix),e=this.countDays(),s=(0,i.nK)(e,["сутки","суток","суток"]);this.$rent.html(`${t} x ${e} ${s}`);const a=(0,i.R3)(this.price*e,this.postfix);this.$rentTotal.html(a)}updateAdditional(){const t=(0,i.R3)(this.calcAdditional(),this.postfix);this.$additionalTotal.html(t)}updateTotalCost(){const t=(0,i.R3)(this.calcTotalCost(),this.postfix);this.$totalCost.html(t)}countDays(){const t=Date.parse(this.$datepicker.attr(o.q8));return(Date.parse(this.$datepicker.attr(o.LX))-t)/864e5-1}calcAdditional(){return this.$guests.attr(o.o9).split(",").map((t=>Number(t))).reduce(((t,e,s)=>t+e*this.additionals[s]),0)}calcTotalCost(){const t=this.countDays(),e=this.calcAdditional();return this.price*t-this.discount+e}render(){this.init(),this.attachEventHandlers()}}n()((()=>{n()(".js-reservation").each(((t,e)=>{const s=n()(e);new c(s).render()}))}))},421:(t,e,s)=>{s.d(e,{Y:()=>a,l:()=>n});const a=".js-text-field__input",n="placeholder"},729:(t,e,s)=>{var a=s(755),n=s.n(a),i=s(462),o=s(421);n()((()=>{n()(o.Y).each(((t,e)=>{const s=n()(e),a=s.attr(o.l);new i.Z({$input:s,inputFormat:"dd.mm.yyyy",placeholder:a}).render()}))}))},563:(t,e,s)=>{s.d(e,{Z:()=>r});var a=s(755),n=s.n(a),i=s(808),o=s(255);class r{constructor(t){this.$component=t.$component,this.texts=t.texts,this.isSplit=t.isSplit,this.triggerValueChanged=t.triggerValueChanged,this.onAcceptButtonClick=t.onAcceptButtonClick,this.DATE_FROM=t.DATE_FROM,this.DATE_TO=t.DATE_TO;const{range:e,altField:s,$content:a}=t,n=this.createAirOptions({range:e,altField:s}),o=new i.Z(a[0],n);return this.$clear=r.findClearButton(o),this.updateClearButtonVisability(o),r.fixButtonsType(o),o}createAirOptions(t){return{...t,inline:!0,locale:o.Z,altFieldDateFormat:"d MMM",prevHtml:"",nextHtml:"",multipleDatesSeparator:" - ",dateFormat:"d MMM",moveToOtherMonthsOnSelect:!1,navTitles:{days:"MMMM yyyy"},onSelect:t=>this.onCellSelect(t),buttons:[{content:"очистить",className:"clear",onClick:t=>this.onClearCalendarClick(t)},{content:"применить",className:"accept",onClick:()=>this.onAcceptButtonClick()}]}}setState(t,e){this.setTexts(t,e),this.setValues(t,e)}setValues(t,e){const s=r.dateToString(t),a=r.dateToString(e);this.$component.attr(this.DATE_FROM,s),this.$component.attr(this.DATE_TO,a)}setTexts(t,e){if(!this.isSplit)return;const s=r.dateToString(t,"ru"),a=r.dateToString(e,"ru");n()(this.texts[0]).val(s),n()(this.texts[1]).val(a)}onCellSelect({date:t,datepicker:e}){const[s,a]=e.selectedDates,n=1===e.selectedDates.length,i=2===e.selectedDates.length;n?(r.fixFocusDisplay(t,e),this.setState(s,"")):i&&this.setState(s,a),this.update(e)}onClearCalendarClick(t){t.clear(),this.isSplit&&n()(this.texts[1]).val("")}update(t){this.updateClearButtonVisability(t),this.triggerValueChanged()}updateClearButtonVisability(t){0!==t.selectedDates.length?this.$clear.show():this.$clear.hide()}static findClearButton(t){const e=n()("button",t.$buttons);return n()(e[0])}static fixButtonsType(t){n()("button",t.$buttons).attr("type","button")}static fixFocusDisplay(t,e){const s=`.air-datepicker-cell[data-year=${t.getFullYear()}][data-month=${t.getMonth()}][data-date=${t.getDate()}]`,a=n()(s,e.$datepicker);a.hasClass("-focus-")&&(a.addClass("-range-from-"),a.addClass("-range-to-"))}static dateToString(t,e="en"){return"string"==typeof t?t:t.toLocaleDateString(e)}}},255:(t,e,s)=>{s.d(e,{Z:()=>a});const a={days:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],daysShort:["Вос","Пон","Вто","Сре","Чет","Пят","Суб"],daysMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthsShort:["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"],today:"Сегодня",clear:"Очистить",dateFormat:"dd.MM.yyyy",timeFormat:"HH:mm",firstDay:1}},462:(t,e,s)=>{s.d(e,{Z:()=>i});var a=s(382),n=s.n(a);class i{constructor({$input:t,inputFormat:e,placeholder:s}){const a={alias:"datetime",inputFormat:e,placeholder:s};this.outsideInputmask=new(n())(a),this.$input=t}render(){this.outsideInputmask.mask(this.$input)}}},938:(t,e,s)=>{function a(t,e){if(t>10&&t<20)return e[2];switch(t%10){case 1:return e[0];case 2:case 3:case 4:return e[1];default:return e[2]}}function n(t,e="",s="ru"){return`${t.toLocaleString(s)}${e}`}s.d(e,{nK:()=>a,R3:()=>n})}}]);